import{_ as Z,g as ee,u as te,a as se,r as i,G as oe,k as Y,o as ae,h as ne,i as l,c as r,b as t,e as le,w as re,j as ie,t as n,F as A,p as z,n as D,J as b,L as j,l as V,K as N,d as g,R as M}from"./index-367fd436.js";const de={class:"mb-8"},ce={class:"flex items-center justify-between"},ue={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},pe={class:"bg-white rounded-lg shadow-sm p-6"},ve={class:"flex items-center"},me={class:"ml-4"},ge={class:"text-2xl font-semibold text-gray-900"},fe={class:"bg-white rounded-lg shadow-sm p-6"},xe={class:"flex items-center"},he={class:"ml-4"},ye={class:"text-2xl font-semibold text-gray-900"},_e={class:"bg-white rounded-lg shadow-sm p-6"},be={class:"flex items-center"},ke={class:"ml-4"},we={class:"text-2xl font-semibold text-gray-900"},De={class:"bg-white rounded-lg shadow-sm p-6"},Me={class:"flex items-center"},Te={class:"ml-4"},Ce={class:"text-2xl font-semibold text-gray-900"},Le={class:"bg-white rounded-lg shadow-sm"},Fe={class:"border-b border-gray-200"},He={class:"-mb-px flex space-x-8 px-6"},Ae=["onClick"],je={class:"p-6"},Ve={key:0,class:"space-y-4"},Be={class:"flex justify-between items-center mb-4"},Se={class:"flex space-x-2"},Re={key:0,class:"mb-4 p-4 bg-gray-50 rounded-lg"},Ye={class:"flex items-center space-x-4"},ze={key:1,class:"mb-4 p-3 bg-blue-50 rounded-lg"},Ne={class:"flex items-center justify-between"},Ue={class:"flex items-center space-x-2"},Pe={class:"text-sm text-blue-700"},Ee={class:"mb-4 p-3 bg-gray-50 rounded-lg"},$e={class:"flex items-center justify-between"},We={class:"flex items-center space-x-2"},Ie={class:"text-sm font-medium text-gray-700"},Oe={key:0,class:"text-sm text-gray-500"},Ge={key:2,class:"flex justify-center py-8"},Je={key:3,class:"space-y-3"},Ke={class:"flex items-center justify-between"},qe={class:"flex-1"},Qe={class:"flex items-center space-x-2 mb-2"},Xe={class:"font-medium text-gray-900"},Ze={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800"},et={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},tt={class:"text-sm text-gray-600"},st={class:"flex items-center space-x-4 mt-2 text-xs text-gray-500"},ot={class:"flex space-x-2"},at=["onClick"],nt=["onClick"],lt=["onClick"],rt={key:4,class:"text-center py-8"},it={key:5,class:"text-center py-8"},dt={key:1,class:"space-y-4"},ct={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ut={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},pt={class:"flex items-center mb-4"},vt={class:"ml-3"},mt={class:"text-lg font-medium text-gray-900"},gt={class:"mb-6"},ft={class:"text-sm text-gray-600"},xt={__name:"ForumManage",setup(ht){ee(),te();const u=se(),T=i(!1),k=i("topics"),d=i([]),p=i(""),c=i(""),v=i("newest"),f=i(""),x=i(""),m=oe({totalTopics:0,activeTopics:0,pinnedTopics:0,lockedTopics:0}),C=i(!1),L=i(""),F=i(""),H=i(""),y=i(null),U=[{id:"topics",name:"Topics"},{id:"reports",name:"Reports"}],_=Y(()=>{let o=[...d.value];if(p.value&&(o=o.filter(e=>{switch(p.value){case"pinned":return e.is_pinned;case"locked":return e.is_locked;case"reported":return e.reports_count>0;case"active":return!e.is_locked;default:return!0}})),c.value&&c.value!=="custom"){const e=$(c.value);o=o.filter(a=>{const s=new Date(a.created_at);return s>=e.start&&s<=e.end})}if(c.value==="custom"&&f.value&&x.value){const e=new Date(f.value),a=new Date(x.value);a.setHours(23,59,59,999),o=o.filter(s=>{const h=new Date(s.created_at);return h>=e&&h<=a})}return o.sort((e,a)=>{if(e.is_pinned&&!a.is_pinned)return-1;if(!e.is_pinned&&a.is_pinned)return 1;switch(v.value){case"newest":return new Date(a.created_at)-new Date(e.created_at);case"oldest":return new Date(e.created_at)-new Date(a.created_at);case"most_replied":return(a.replies_count||0)-(e.replies_count||0);case"most_viewed":return(a.views||0)-(e.views||0);case"alphabetical":return e.title.localeCompare(a.title);default:return new Date(a.created_at)-new Date(e.created_at)}}),o}),P=o=>({general:"bg-blue-100 text-blue-800",technical:"bg-green-100 text-green-800","course-specific":"bg-purple-100 text-purple-800",feedback:"bg-orange-100 text-orange-800"})[o]||"bg-gray-100 text-gray-800",E=o=>new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),$=o=>{const e=new Date,a=new Date,s=new Date;switch(o){case"today":a.setHours(0,0,0,0),s.setHours(23,59,59,999);break;case"yesterday":a.setDate(e.getDate()-1),a.setHours(0,0,0,0),s.setDate(e.getDate()-1),s.setHours(23,59,59,999);break;case"this_week":a.setDate(e.getDate()-e.getDay()),a.setHours(0,0,0,0),s.setHours(23,59,59,999);break;case"last_week":a.setDate(e.getDate()-e.getDay()-7),a.setHours(0,0,0,0),s.setDate(e.getDate()-e.getDay()-1),s.setHours(23,59,59,999);break;case"this_month":a.setDate(1),a.setHours(0,0,0,0),s.setHours(23,59,59,999);break;case"last_month":a.setMonth(e.getMonth()-1,1),a.setHours(0,0,0,0),s.setDate(0),s.setHours(23,59,59,999);break;case"last_3_months":a.setMonth(e.getMonth()-3),a.setHours(0,0,0,0),s.setHours(23,59,59,999);break;case"last_6_months":a.setMonth(e.getMonth()-6),a.setHours(0,0,0,0),s.setHours(23,59,59,999);break;case"this_year":a.setMonth(0,1),a.setHours(0,0,0,0),s.setHours(23,59,59,999);break;case"last_year":a.setFullYear(e.getFullYear()-1,0,1),a.setHours(0,0,0,0),s.setFullYear(e.getFullYear()-1,11,31),s.setHours(23,59,59,999);break;default:a.setFullYear(2e3),s.setHours(23,59,59,999)}return{start:a,end:s}},W=Y(()=>p.value||c.value||v.value!=="newest"),I=()=>{const o=[];if(c.value){const e={today:"Today",yesterday:"Yesterday",this_week:"This Week",last_week:"Last Week",this_month:"This Month",last_month:"Last Month",last_3_months:"Last 3 Months",last_6_months:"Last 6 Months",this_year:"This Year",last_year:"Last Year",custom:"Custom Range"};o.push(e[c.value]||c.value)}if(p.value){const e={pinned:"Pinned",locked:"Locked",reported:"Reported",active:"Active"};o.push(e[p.value]||p.value)}if(v.value!=="newest"){const e={oldest:"Oldest First",most_replied:"Most Replied",most_viewed:"Most Viewed",alphabetical:"Alphabetical"};o.push(e[v.value]||v.value)}return o.join(", ")},O=()=>{if(!f.value||!x.value){u.error("Please select both start and end dates");return}if(new Date(f.value)>new Date(x.value)){u.error("Start date cannot be after end date");return}u.success("Custom date range applied")},B=()=>{p.value="",c.value="",v.value="newest",f.value="",x.value="",u.success("All filters cleared")},G=async()=>{T.value=!0;try{const o=await M.getAllTopics({per_page:100});o.data.status==="success"&&(d.value=o.data.data.data||o.data.data,w())}catch(o){console.error("Error fetching topics:",o),u.error("Failed to load topics")}finally{T.value=!1}},w=()=>{m.totalTopics=d.value.length,m.activeTopics=d.value.filter(o=>!o.is_locked).length,m.pinnedTopics=d.value.filter(o=>o.is_pinned).length,m.lockedTopics=d.value.filter(o=>o.is_locked).length},J=async o=>{try{const e=await M.pinStandaloneTopic(o.id);e.data.status==="success"&&(o.is_pinned=e.data.data.is_pinned,w(),u.success(e.data.message))}catch(e){console.error("Error pinning topic:",e),u.error("Failed to update topic")}},K=async o=>{try{const e=await M.lockStandaloneTopic(o.id);e.data.status==="success"&&(o.is_locked=e.data.data.is_locked,w(),u.success(e.data.message))}catch(e){console.error("Error locking topic:",e),u.error("Failed to update topic")}},q=(o,e)=>{H.value=o,y.value=e,o==="topic"&&(L.value="Delete Topic",F.value=`Are you sure you want to delete the topic "${e.title}"? This action cannot be undone.`),C.value=!0},Q=async()=>{if(y.value)try{H.value==="topic"&&(await M.deleteStandaloneTopic(y.value.id),d.value=d.value.filter(o=>o.id!==y.value.id),w(),u.success("Topic deleted successfully"))}catch(o){console.error("Error deleting item:",o),u.error("Failed to delete item")}finally{S()}},S=()=>{C.value=!1,L.value="",F.value="",H.value="",y.value=null},X=o=>{q("topic",o)};return ae(()=>{G()}),(o,e)=>{const a=ne("router-link");return l(),r(A,null,[t("div",null,[t("div",de,[t("div",ce,[e[6]||(e[6]=t("div",null,[t("h1",{class:"text-3xl font-bold text-gray-900"},"Forum Management"),t("p",{class:"mt-2 text-gray-600"},"Manage forum topics, categories, and moderation")],-1)),le(a,{to:"/forum",class:"btn btn-secondary"},{default:re(()=>e[5]||(e[5]=[ie(" Back to Forum ",-1)])),_:1,__:[5]})])]),t("div",ue,[t("div",pe,[t("div",ve,[e[8]||(e[8]=t("div",{class:"p-2 bg-blue-100 rounded-lg"},[t("svg",{class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})])],-1)),t("div",me,[e[7]||(e[7]=t("p",{class:"text-sm font-medium text-gray-600"},"Total Topics",-1)),t("p",ge,n(m.totalTopics),1)])])]),t("div",fe,[t("div",xe,[e[10]||(e[10]=t("div",{class:"p-2 bg-green-100 rounded-lg"},[t("svg",{class:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",he,[e[9]||(e[9]=t("p",{class:"text-sm font-medium text-gray-600"},"Active Topics",-1)),t("p",ye,n(m.activeTopics),1)])])]),t("div",_e,[t("div",be,[e[12]||(e[12]=t("div",{class:"p-2 bg-yellow-100 rounded-lg"},[t("svg",{class:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})])],-1)),t("div",ke,[e[11]||(e[11]=t("p",{class:"text-sm font-medium text-gray-600"},"Pinned Topics",-1)),t("p",we,n(m.pinnedTopics),1)])])]),t("div",De,[t("div",Me,[e[14]||(e[14]=t("div",{class:"p-2 bg-red-100 rounded-lg"},[t("svg",{class:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),t("div",Te,[e[13]||(e[13]=t("p",{class:"text-sm font-medium text-gray-600"},"Locked Topics",-1)),t("p",Ce,n(m.lockedTopics),1)])])])]),t("div",Le,[t("div",Fe,[t("nav",He,[(l(),r(A,null,z(U,s=>t("button",{key:s.id,onClick:h=>k.value=s.id,class:D(["py-4 px-1 border-b-2 font-medium text-sm",k.value===s.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},n(s.name),11,Ae)),64))])]),t("div",je,[k.value==="topics"?(l(),r("div",Ve,[t("div",Be,[e[18]||(e[18]=t("h3",{class:"text-lg font-medium text-gray-900"},"Manage Topics",-1)),t("div",Se,[b(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>c.value=s),class:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"},e[15]||(e[15]=[V('<option value="" data-v-c491f521>All Time</option><option value="today" data-v-c491f521>Today</option><option value="yesterday" data-v-c491f521>Yesterday</option><option value="this_week" data-v-c491f521>This Week</option><option value="last_week" data-v-c491f521>Last Week</option><option value="this_month" data-v-c491f521>This Month</option><option value="last_month" data-v-c491f521>Last Month</option><option value="last_3_months" data-v-c491f521>Last 3 Months</option><option value="last_6_months" data-v-c491f521>Last 6 Months</option><option value="this_year" data-v-c491f521>This Year</option><option value="last_year" data-v-c491f521>Last Year</option><option value="custom" data-v-c491f521>Custom Range</option>',12)]),512),[[j,c.value]]),b(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>p.value=s),class:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"},e[16]||(e[16]=[V('<option value="" data-v-c491f521>All Topics</option><option value="pinned" data-v-c491f521>Pinned</option><option value="locked" data-v-c491f521>Locked</option><option value="reported" data-v-c491f521>Reported</option><option value="active" data-v-c491f521>Active (Unlocked)</option>',5)]),512),[[j,p.value]]),b(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>v.value=s),class:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"},e[17]||(e[17]=[V('<option value="newest" data-v-c491f521>Newest First</option><option value="oldest" data-v-c491f521>Oldest First</option><option value="most_replied" data-v-c491f521>Most Replied</option><option value="most_viewed" data-v-c491f521>Most Viewed</option><option value="alphabetical" data-v-c491f521>Alphabetical</option>',5)]),512),[[j,v.value]])])]),c.value==="custom"?(l(),r("div",Re,[t("div",Ye,[t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"From Date",-1)),b(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>f.value=s),type:"date",class:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"},null,512),[[N,f.value]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"To Date",-1)),b(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>x.value=s),type:"date",class:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"},null,512),[[N,x.value]])]),t("div",{class:"flex items-end"},[t("button",{onClick:O,class:"btn btn-primary"}," Apply ")])])])):g("",!0),W.value?(l(),r("div",ze,[t("div",Ne,[t("div",Ue,[e[21]||(e[21]=t("svg",{class:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z"})],-1)),e[22]||(e[22]=t("span",{class:"text-sm font-medium text-blue-800"},"Active Filters:",-1)),t("span",Pe,n(I()),1)]),t("button",{onClick:B,class:"text-sm text-blue-600 hover:text-blue-800 underline"}," Clear All ")])])):g("",!0),t("div",Ee,[t("div",$e,[t("div",We,[e[23]||(e[23]=t("svg",{class:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1)),t("span",Ie," Showing "+n(_.value.length)+" of "+n(d.value.length)+" topics ",1)]),_.value.length!==d.value.length?(l(),r("div",Oe,n(d.value.length-_.value.length)+" hidden by filters ",1)):g("",!0)])]),T.value?(l(),r("div",Ge,e[24]||(e[24]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1)]))):_.value.length>0?(l(),r("div",Je,[(l(!0),r(A,null,z(_.value,s=>{var h;return l(),r("div",{key:s.id,class:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50"},[t("div",Ke,[t("div",qe,[t("div",Qe,[t("h4",Xe,n(s.title),1),t("span",{class:D(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",P(s.category)])},n(s.category),3),s.is_pinned?(l(),r("span",Ze," Pinned ")):g("",!0),s.is_locked?(l(),r("span",et," Locked ")):g("",!0)]),t("p",tt,n(s.content.substring(0,100))+"...",1),t("div",st,[t("span",null,"By "+n((h=s.user)==null?void 0:h.name),1),t("span",null,n(E(s.created_at)),1),t("span",null,n(s.replies_count||0)+" replies",1)])]),t("div",ot,[t("button",{onClick:R=>J(s),class:D(["btn btn-sm",s.is_pinned?"btn-warning":"btn-secondary"])},n(s.is_pinned?"Unpin":"Pin"),11,at),t("button",{onClick:R=>K(s),class:D(["btn btn-sm",s.is_locked?"btn-danger":"btn-secondary"])},n(s.is_locked?"Unlock":"Lock"),11,nt),t("button",{onClick:R=>X(s),class:"btn btn-sm btn-danger"}," Delete ",8,lt)])])])}),128))])):d.value.length===0?(l(),r("div",rt,e[25]||(e[25]=[t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1),t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No topics found",-1),t("p",{class:"mt-1 text-sm text-gray-500"},"There are no forum topics in the system yet.",-1)]))):(l(),r("div",it,[e[26]||(e[26]=t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z"})],-1)),e[27]||(e[27]=t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No topics match your filters",-1)),e[28]||(e[28]=t("p",{class:"mt-1 text-sm text-gray-500"},"Try adjusting your filter criteria to see more results.",-1)),t("div",{class:"mt-4"},[t("button",{onClick:B,class:"btn btn-primary"}," Clear All Filters ")])]))])):g("",!0),k.value==="reports"?(l(),r("div",dt,e[29]||(e[29]=[t("h3",{class:"text-lg font-medium text-gray-900"},"Reported Content",-1),t("div",{class:"text-center py-8"},[t("p",{class:"text-gray-500"},"No reported content found")],-1)]))):g("",!0)])])]),C.value?(l(),r("div",ct,[t("div",ut,[t("div",pt,[e[30]||(e[30]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),t("div",vt,[t("h3",mt,n(L.value),1)])]),t("div",gt,[t("p",ft,n(F.value),1)]),t("div",{class:"flex space-x-3"},[t("button",{onClick:S,class:"btn btn-secondary flex-1"}," Cancel "),t("button",{onClick:Q,class:"btn btn-danger flex-1"}," Delete ")])])])):g("",!0)],64)}}},_t=Z(xt,[["__scopeId","data-v-c491f521"]]);export{_t as default};

import{_ as Q,a as W,u as X,r as x,k as Z,o as ee,c as d,b as t,d as b,t as r,e as A,w as j,I as E,J as C,L as M,l as te,F as T,p as B,K as se,g as oe,N as _,O as ae,h as re,i as u,j as h,P as le,n as ne}from"./index-367fd436.js";const ie={class:"min-h-screen bg-gray-50 py-8"},de={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},ue={class:"mb-8"},ce={class:"flex items-center justify-between"},pe={class:"flex space-x-3"},ge=["disabled"],ve={key:0,class:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24"},xe={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-6 mb-8 text-center"},fe={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-6 mb-8 text-center"},ye={key:2},me={class:"bg-white rounded-lg shadow-sm p-6 mb-6 border border-gray-200"},be={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},_e=["value"],he={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"},we={class:"flex items-center justify-between"},Ce={class:"text-blue-800"},ke={class:"flex space-x-2"},Ae=["disabled"],je=["disabled"],Se={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},Fe={class:"px-6 py-4 border-b border-gray-200"},Ve={class:"flex items-center justify-between"},$e={class:"text-lg font-medium text-gray-900"},De={class:"flex items-center space-x-2"},Pe={class:"flex items-center space-x-2"},Ne=["checked"],Re={class:"overflow-x-auto"},Ee={class:"min-w-full divide-y divide-gray-200"},Me={class:"bg-white divide-y divide-gray-200"},Te={key:0,class:"bg-white"},Be={key:1,class:"bg-white"},Ue={class:"px-6 py-4 whitespace-nowrap"},Le={class:"flex items-center"},ze=["value"],Ge={class:"text-sm font-medium text-gray-900"},He={class:"text-sm text-gray-500"},Ie={class:"px-6 py-4 whitespace-nowrap"},Oe={class:"text-sm text-gray-900"},Je={class:"text-sm text-gray-500"},Ke={class:"px-6 py-4 whitespace-nowrap"},Ye={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},qe={class:"px-6 py-4 whitespace-nowrap"},Qe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},We={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Xe={class:"flex space-x-2"},Ze=["onClick","disabled"],et=["onClick","disabled"],tt=["onClick"],st=["onClick"],ot=["onClick","disabled"],at={key:0,class:"px-6 py-4 border-t border-gray-200"},rt={class:"flex items-center justify-between"},lt={class:"text-sm text-gray-700"},nt={class:"flex space-x-2"},it=["disabled"],dt=["disabled"],ut={__name:"AdminCourses",setup(ct){const S=oe(),c=W(),f=X(),y=x(!1),g=x(!1),n=x([]),F=x([]),i=x([]),w=x(!1),v=x({status:"",category:"",search:""}),l=x({current_page:1,per_page:15,total:0,from:0,to:0,last_page:1});let V=null;const U=()=>{clearTimeout(V),V=setTimeout(()=>{k()},500)},p=async()=>{if(!(!f.isAuthenticated||!f.isAdmin)){y.value=!0;try{const o={page:l.value.current_page,per_page:l.value.per_page,...v.value};Object.keys(o).forEach(s=>{(o[s]===""||o[s]===null||o[s]===void 0)&&delete o[s]});const a=(await _.getAllCourses(o)).data.data;n.value=a.data||[],l.value={current_page:a.current_page||1,per_page:a.per_page||15,total:a.total||0,from:a.from||0,to:a.to||0,last_page:a.last_page||1},console.log("âœ… Courses loaded successfully:",n.value.length)}catch(o){console.error("âŒ Error fetching courses:",o),c.error("Failed to load courses")}finally{y.value=!1}}},$=async()=>{try{const o=await ae.getAll();F.value=o.data.data||[]}catch(o){console.error("âŒ Error fetching categories:",o)}},k=()=>{l.value.current_page=1,p()},L=()=>{v.value={status:"",category:"",search:""},l.value.current_page=1,p()},D=o=>{o>=1&&o<=l.value.last_page&&(l.value.current_page=o,p())},z=()=>{w.value?i.value=n.value.map(o=>o.id):i.value=[]};Z(()=>n.value.length===0?!1:i.value.length===n.value.length);const G=async o=>{try{const e=n.value.find(a=>a.id===o);e&&(e.approving=!0),await _.approveCourse(o),c.success("Course approved successfully!"),await p()}catch(e){console.error("âŒ Error approving course:",e),c.error("Failed to approve course")}finally{const e=n.value.find(a=>a.id===o);e&&(e.approving=!1)}},H=async o=>{try{const e=n.value.find(a=>a.id===o);e&&(e.rejecting=!0),await _.rejectCourse(o,"Rejected by admin"),c.success("Course rejected successfully!"),await p()}catch(e){console.error("âŒ Error rejecting course:",e),c.error("Failed to reject course")}finally{const e=n.value.find(a=>a.id===o);e&&(e.rejecting=!1)}},I=async()=>{if(i.value.length!==0){g.value=!0;try{await _.bulkApproveCourses({course_ids:i.value}),c.success(`${i.value.length} course(s) approved successfully!`),i.value=[],w.value=!1,await p()}catch(o){console.error("âŒ Error bulk approving courses:",o),c.error("Failed to approve courses")}finally{g.value=!1}}},O=async()=>{if(i.value.length!==0){g.value=!0;try{for(const o of i.value)await _.rejectCourse(o,"Bulk rejected by admin");c.success(`${i.value.length} course(s) rejected successfully!`),i.value=[],w.value=!1,await p()}catch(o){console.error("âŒ Error bulk rejecting courses:",o),c.error("Failed to reject courses")}finally{g.value=!1}}},J=o=>{const e=n.value.find(a=>a.id===o);e&&e.slug?S.push(`/courses/${e.slug}`):c.error("Course not found or missing slug")},K=o=>{const e=n.value.find(a=>a.id===o);e&&e.slug?S.push(`/courses/${e.slug}/lessons?admin=true`):c.error("Course not found or missing slug")},Y=async o=>{if(confirm("Are you sure you want to delete this course? This action cannot be undone."))try{const e=n.value.find(a=>a.id===o);e&&(e.deleting=!0),c.success("Course deleted successfully!"),await p()}catch(e){console.error("âŒ Error deleting course:",e),c.error("Failed to delete course")}finally{const e=n.value.find(a=>a.id===o);e&&(e.deleting=!1)}},q=async()=>{await Promise.all([p(),$()])};return ee(async()=>{console.log("ðŸš€ AdminCourses component mounted"),f.isAuthenticated&&f.isAdmin&&await Promise.all([p(),$()])}),(o,e)=>{const a=re("router-link");return u(),d("div",ie,[t("div",de,[t("div",ue,[t("div",ce,[e[8]||(e[8]=t("div",null,[t("h1",{class:"text-3xl font-bold text-gray-900"},"Course Management"),t("p",{class:"mt-2 text-gray-600"},"Manage all platform courses")],-1)),t("div",pe,[t("button",{onClick:q,disabled:y.value,class:"btn btn-secondary flex items-center space-x-2"},[y.value?(u(),d("svg",ve,e[6]||(e[6]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):b("",!0),t("span",null,r(y.value?"Refreshing...":"Refresh"),1)],8,ge),A(a,{to:"/admin",class:"btn btn-primary"},{default:j(()=>e[7]||(e[7]=[h(" Back to Dashboard ",-1)])),_:1,__:[7]})])])]),E(f).isAuthenticated?E(f).isAdmin?(u(),d("div",ye,[t("div",me,[t("div",be,[t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Status Filter",-1)),C(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>v.value.status=s),onChange:k,class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},e[15]||(e[15]=[te('<option value="" data-v-9ac51588>All Statuses</option><option value="pending" data-v-9ac51588>Pending</option><option value="approved" data-v-9ac51588>Approved</option><option value="rejected" data-v-9ac51588>Rejected</option><option value="draft" data-v-9ac51588>Draft</option>',5)]),544),[[M,v.value.status]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Category Filter",-1)),C(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>v.value.category=s),onChange:k,class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[e[17]||(e[17]=t("option",{value:""},"All Categories",-1)),(u(!0),d(T,null,B(F.value,s=>(u(),d("option",{key:s.id,value:s.id},r(s.name),9,_e))),128))],544),[[M,v.value.category]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Search",-1)),C(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>v.value.search=s),onInput:U,type:"text",placeholder:"Search courses...",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544),[[se,v.value.search]])]),t("div",{class:"flex items-end"},[t("button",{onClick:L,class:"w-full bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500"}," Clear Filters ")])])]),i.value.length>0?(u(),d("div",he,[t("div",we,[t("span",Ce,r(i.value.length)+" course(s) selected ",1),t("div",ke,[t("button",{onClick:I,disabled:g.value,class:"btn btn-success"},r(g.value?"Approving...":"Approve Selected"),9,Ae),t("button",{onClick:O,disabled:g.value,class:"btn btn-danger"},r(g.value?"Rejecting...":"Reject Selected"),9,je)])])])):b("",!0),t("div",Se,[t("div",Fe,[t("div",Ve,[t("h3",$e," Courses ("+r(l.value.total)+") ",1),t("div",De,[t("label",Pe,[t("input",{type:"checkbox",onChange:z,checked:w.value,class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,40,Ne),e[20]||(e[20]=t("span",{class:"text-sm text-gray-700"},"Select All",-1))])])])]),t("div",Re,[t("table",Ee,[e[25]||(e[25]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Course "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Instructor "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Category "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Price "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),t("tbody",Me,[y.value?(u(),d("tr",Te,e[21]||(e[21]=[t("td",{colspan:"6",class:"px-6 py-12 text-center"},[t("div",{class:"flex justify-center"},[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})])],-1)]))):n.value.length===0?(u(),d("tr",Be,e[22]||(e[22]=[t("td",{colspan:"6",class:"px-6 py-12 text-center text-gray-500"}," No courses found ",-1)]))):(u(!0),d(T,{key:2},B(n.value,s=>{var P,N,R;return u(),d("tr",{key:s.id,class:"hover:bg-gray-50"},[t("td",Ue,[t("div",Le,[C(t("input",{type:"checkbox",value:s.id,"onUpdate:modelValue":e[3]||(e[3]=m=>i.value=m),class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"},null,8,ze),[[le,i.value]]),t("div",null,[t("div",Ge,r(s.title),1),t("div",He,r(s.slug),1)])])]),t("td",Ie,[t("div",Oe,r(((P=s.instructor)==null?void 0:P.name)||"Unknown"),1),t("div",Je,r(((N=s.instructor)==null?void 0:N.email)||"No email"),1)]),t("td",Ke,[t("span",Ye,r(((R=s.category)==null?void 0:R.name)||"No Category"),1)]),t("td",qe,[t("span",{class:ne(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",{"bg-yellow-100 text-yellow-800":s.status==="pending","bg-green-100 text-green-800":s.status==="approved","bg-red-100 text-red-800":s.status==="rejected","bg-gray-100 text-gray-800":s.status==="draft"}])},r(s.status),3)]),t("td",Qe," $"+r(s.price||0),1),t("td",We,[t("div",Xe,[s.status==="pending"?(u(),d("button",{key:0,onClick:m=>G(s.id),disabled:s.approving,class:"text-green-600 hover:text-green-900 disabled:opacity-50"},r(s.approving?"Approving...":"Approve"),9,Ze)):b("",!0),s.status==="pending"?(u(),d("button",{key:1,onClick:m=>H(s.id),disabled:s.rejecting,class:"text-red-600 hover:text-red-900 disabled:opacity-50"},r(s.rejecting?"Rejecting...":"Reject"),9,et)):b("",!0),t("button",{onClick:m=>J(s.id),class:"text-blue-600 hover:text-blue-900 mr-2",title:"View Course Details"},e[23]||(e[23]=[t("i",{class:"fas fa-eye"},null,-1),h(" View ",-1)]),8,tt),t("button",{onClick:m=>K(s.id),class:"text-green-600 hover:text-green-900",title:"Preview Course Content"},e[24]||(e[24]=[t("i",{class:"fas fa-eye"},null,-1),h(" Content ",-1)]),8,st),t("button",{onClick:m=>Y(s.id),disabled:s.deleting,class:"text-red-600 hover:text-red-900 disabled:opacity-50"},r(s.deleting?"Deleting...":"Delete"),9,ot)])])])}),128))])])]),l.value.total>l.value.per_page?(u(),d("div",at,[t("div",rt,[t("div",lt," Showing "+r(l.value.from)+" to "+r(l.value.to)+" of "+r(l.value.total)+" results ",1),t("div",nt,[t("button",{onClick:e[4]||(e[4]=s=>D(l.value.current_page-1)),disabled:l.value.current_page===1,class:"px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50"}," Previous ",8,it),t("button",{onClick:e[5]||(e[5]=s=>D(l.value.current_page+1)),disabled:l.value.current_page>=l.value.last_page,class:"px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50"}," Next ",8,dt)])])])):b("",!0)])])):(u(),d("div",fe,[e[13]||(e[13]=t("h3",{class:"text-lg font-medium text-red-800 mb-2"},"Access Denied",-1)),e[14]||(e[14]=t("p",{class:"text-red-600"},"You do not have admin privileges to access course management.",-1)),A(a,{to:"/",class:"inline-block mt-3 bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700"},{default:j(()=>e[12]||(e[12]=[h(" Go Home ",-1)])),_:1,__:[12]})])):(u(),d("div",xe,[e[10]||(e[10]=t("h3",{class:"text-lg font-medium text-red-800 mb-2"},"Access Denied",-1)),e[11]||(e[11]=t("p",{class:"text-red-600"},"Please log in to access course management.",-1)),A(a,{to:"/login",class:"inline-block mt-3 bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700"},{default:j(()=>e[9]||(e[9]=[h(" Go to Login ",-1)])),_:1,__:[9]})]))])])}}},gt=Q(ut,[["__scopeId","data-v-9ac51588"]]);export{gt as default};

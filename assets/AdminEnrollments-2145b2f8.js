import{i as r,c as a,b as e,u as re,r as m,k as x,H as ae,o as ie,t as l,J,K as de,L as ue,l as ce,F as K,p as q,j as u,e as h,I as w,d as g,n as N,M as pe}from"./index-367fd436.js";import{a as me,r as xe}from"./XMarkIcon-802faa26.js";import{r as ge,a as ve}from"./ChevronRightIcon-f49e6b53.js";function ye(V,v){return r(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function fe(V,v){return r(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})])}function he(V,v){return r(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}const we={class:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 mb-6"},be={class:"bg-white rounded-lg shadow p-3 sm:p-6"},_e={class:"text-xl sm:text-3xl font-bold text-gray-900"},ke={class:"bg-white rounded-lg shadow p-3 sm:p-6"},Ce={class:"text-xl sm:text-3xl font-bold text-green-600"},Ee={class:"bg-white rounded-lg shadow p-3 sm:p-6"},je={class:"text-xl sm:text-3xl font-bold text-yellow-600"},$e={class:"bg-white rounded-lg shadow p-3 sm:p-6"},Me={class:"text-xl sm:text-3xl font-bold text-blue-600"},De={class:"bg-white rounded-lg shadow p-6 mb-6"},Ae={class:"flex gap-4"},Te={class:"flex-1"},Pe={class:"min-w-[200px]"},Ve={class:"bg-white rounded-lg shadow overflow-hidden"},Se={class:"overflow-x-auto"},Fe={class:"min-w-full divide-y divide-gray-200"},Be={class:"bg-white divide-y divide-gray-200"},Le={key:0,class:"animate-pulse"},Ne={key:1,class:"text-center"},ze={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ie={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Ue={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ze={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},He={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ge={class:"px-6 py-4 whitespace-nowrap"},Re={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Je={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ke={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},qe={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Oe={class:"flex gap-2"},Qe=["onClick"],We=["onClick"],Xe=["onClick"],Ye=["onClick"],et={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},tt={class:"flex-1 flex justify-between sm:hidden"},st=["disabled"],ot=["disabled"],lt={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},nt={class:"text-sm text-gray-700"},rt={class:"font-medium"},at={class:"font-medium"},it={class:"font-medium"},dt={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px"},ut=["disabled"],ct=["onClick"],pt=["disabled"],mt={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},xt={class:"relative top-20 mx-auto p-5 border w-full max-w-4xl shadow-lg rounded-md bg-white"},gt={class:"mt-3"},vt={class:"flex justify-between items-center mb-4"},yt={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ft={class:"space-y-2"},ht={class:"space-y-2"},wt={class:"space-y-2"},bt={key:0},_t={class:"space-y-2"},kt={key:0},Ct={class:"mt-6 flex justify-end"},Et={key:1,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},jt={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},$t={class:"mt-3 text-center"},Mt={class:"text-sm text-gray-500 mb-6"},Dt={class:"flex gap-3 justify-center"},D=10,Vt={__name:"AdminEnrollments",setup(V){const v=re(),y=pe(),b=m([]),S=m(!1),f=m(""),C=m("all"),A=m(!1),T=m(!1),i=m(null),_=m(null),n=m(1),E=x(()=>{let o=b.value;return f.value&&(o=o.filter(t=>{var d,c,p,j,$,M;return((c=(d=t.student)==null?void 0:d.name)==null?void 0:c.toLowerCase().includes(f.value.toLowerCase()))||((j=(p=t.student)==null?void 0:p.email)==null?void 0:j.toLowerCase().includes(f.value.toLowerCase()))||((M=($=t.course)==null?void 0:$.title)==null?void 0:M.toLowerCase().includes(f.value.toLowerCase()))})),C.value!=="all"&&(o=o.filter(t=>t.status===C.value)),o}),k=x(()=>Math.ceil(E.value.length/D)),O=x(()=>{const o=(n.value-1)*D,t=o+D;return E.value.slice(o,t)}),Q=x(()=>{const o=[];let d=Math.max(1,n.value-Math.floor(2.5)),c=Math.min(k.value,d+5-1);c-d+1<5&&(d=Math.max(1,c-5+1));for(let p=d;p<=c;p++)o.push(p);return o}),W=x(()=>b.value.length),X=x(()=>b.value.filter(o=>o.status==="active").length),Y=x(()=>b.value.filter(o=>o.status==="pending").length),ee=x(()=>b.value.filter(o=>o.status==="completed").length),P=async()=>{var o;try{S.value=!0;const t=await fetch("/api/admin/enrollments",{headers:{Authorization:`Bearer ${v.token}`,"Content-Type":"application/json"}});if(!t.ok)throw new Error("Failed to fetch enrollments");const d=await t.json();b.value=((o=d.data)==null?void 0:o.data)||[]}catch(t){console.error("Error fetching enrollments:",t),y.error("Failed to fetch enrollments")}finally{S.value=!1}},te=o=>{i.value=o,A.value=!0},se=async o=>{try{if(!(await fetch(`/api/admin/enrollments/${o}/approve`,{method:"PATCH",headers:{Authorization:`Bearer ${v.token}`,"Content-Type":"application/json"}})).ok)throw new Error("Failed to approve enrollment");y.success("Enrollment approved successfully!"),await P()}catch(t){console.error("Error approving enrollment:",t),y.error("Failed to approve enrollment")}},oe=async o=>{try{if(!(await fetch(`/api/admin/enrollments/${o}/reject`,{method:"PATCH",headers:{Authorization:`Bearer ${v.token}`,"Content-Type":"application/json"}})).ok)throw new Error("Failed to reject enrollment");y.success("Enrollment rejected successfully!"),await P()}catch(t){console.error("Error rejecting enrollment:",t),y.error("Failed to reject enrollment")}},le=o=>{_.value=o,T.value=!0},ne=async()=>{if(_.value)try{if(!(await fetch(`/api/admin/enrollments/${_.value.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${v.token}`,"Content-Type":"application/json"}})).ok)throw new Error("Failed to delete enrollment");y.success("Enrollment deleted successfully!"),await P(),T.value=!1,_.value=null}catch(o){console.error("Error deleting enrollment:",o),y.error("Failed to delete enrollment")}},F=o=>o?new Date(o).toLocaleDateString():"N/A";return ae([f,C],()=>{n.value=1}),ie(()=>{P()}),(o,t)=>{var d,c,p,j,$,M,z,I,U;return r(),a("div",null,[e("div",we,[e("div",be,[t[9]||(t[9]=e("p",{class:"text-gray-600 text-xs sm:text-sm mb-2"},"Total Enrollments",-1)),e("p",_e,l(W.value),1)]),e("div",ke,[t[10]||(t[10]=e("p",{class:"text-gray-600 text-xs sm:text-sm mb-2"},"Active Enrollments",-1)),e("p",Ce,l(X.value),1)]),e("div",Ee,[t[11]||(t[11]=e("p",{class:"text-gray-600 text-xs sm:text-sm mb-2"},"Pending Approvals",-1)),e("p",je,l(Y.value),1)]),e("div",$e,[t[12]||(t[12]=e("p",{class:"text-gray-600 text-xs sm:text-sm mb-2"},"Completed",-1)),e("p",Me,l(ee.value),1)])]),e("div",De,[e("div",Ae,[e("div",Te,[J(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>f.value=s),type:"text",placeholder:"Search enrollments...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[de,f.value]])]),e("div",Pe,[J(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>C.value=s),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},t[13]||(t[13]=[ce('<option value="all">All Status</option><option value="pending">Pending</option><option value="approved">Approved</option><option value="completed">Completed</option><option value="rejected">Rejected</option>',5)]),512),[[ue,C.value]])])])]),e("div",Ve,[e("div",Se,[e("table",Fe,[t[16]||(t[16]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," ID "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Student "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Email "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Course "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Instructor "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Progress "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Grade "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Enrolled "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",Be,[S.value?(r(),a("tr",Le,t[14]||(t[14]=[e("td",{colspan:"10",class:"px-6 py-4"},[e("div",{class:"h-4 bg-gray-200 rounded"})],-1)]))):E.value.length===0?(r(),a("tr",Ne,t[15]||(t[15]=[e("td",{colspan:"10",class:"px-6 py-4 text-gray-500"}," No enrollments found ",-1)]))):(r(!0),a(K,{key:2},q(O.value,s=>{var B,Z,H,G,R;return r(),a("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",ze,l(s.id),1),e("td",Ie,l(((B=s.student)==null?void 0:B.name)||"Unknown"),1),e("td",Ue,l(((Z=s.student)==null?void 0:Z.email)||"Unknown"),1),e("td",Ze,l(((H=s.course)==null?void 0:H.title)||"Unknown"),1),e("td",He,l(((R=(G=s.course)==null?void 0:G.instructor)==null?void 0:R.name)||"Unknown"),1),e("td",Ge,[e("span",{class:N(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",{"bg-yellow-100 text-yellow-800":s.status==="pending","bg-green-100 text-green-800":s.status==="approved","bg-blue-100 text-blue-800":s.status==="completed","bg-red-100 text-red-800":s.status==="rejected"}])},l(s.status),3)]),e("td",Re,l(s.progress_percentage||0)+"% ",1),e("td",Je,l(s.grade||"N/A"),1),e("td",Ke,l(F(s.enrolled_at)),1),e("td",qe,[e("div",Oe,[e("button",{onClick:L=>te(s),class:"text-blue-600 hover:text-blue-900",title:"View Details"},[h(w(fe),{class:"w-4 h-4"})],8,Qe),s.status==="pending"?(r(),a("button",{key:0,onClick:L=>se(s.id),class:"text-green-600 hover:text-green-900",title:"Approve"},[h(w(ye),{class:"w-4 h-4"})],8,We)):g("",!0),s.status==="pending"?(r(),a("button",{key:1,onClick:L=>oe(s.id),class:"text-red-600 hover:text-red-900",title:"Reject"},[h(w(he),{class:"w-4 h-4"})],8,Xe)):g("",!0),e("button",{onClick:L=>le(s),class:"text-red-600 hover:text-red-900",title:"Delete"},[h(w(me),{class:"w-4 h-4"})],8,Ye)])])])}),128))])])]),k.value>1?(r(),a("div",et,[e("div",tt,[e("button",{onClick:t[2]||(t[2]=s=>n.value=Math.max(1,n.value-1)),disabled:n.value===1,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,st),e("button",{onClick:t[3]||(t[3]=s=>n.value=Math.min(k.value,n.value+1)),disabled:n.value===k.value,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,ot)]),e("div",lt,[e("div",null,[e("p",nt,[t[17]||(t[17]=u(" Showing ",-1)),e("span",rt,l((n.value-1)*D+1),1),t[18]||(t[18]=u(" to ",-1)),e("span",at,l(Math.min(n.value*D,E.value.length)),1),t[19]||(t[19]=u(" of ",-1)),e("span",it,l(E.value.length),1),t[20]||(t[20]=u(" results ",-1))])]),e("div",null,[e("nav",dt,[e("button",{onClick:t[4]||(t[4]=s=>n.value=Math.max(1,n.value-1)),disabled:n.value===1,class:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[h(w(ge),{class:"h-5 w-5"})],8,ut),(r(!0),a(K,null,q(Q.value,s=>(r(),a("button",{key:s,onClick:B=>n.value=s,class:N([s===n.value?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50","relative inline-flex items-center px-4 py-2 border text-sm font-medium"])},l(s),11,ct))),128)),e("button",{onClick:t[5]||(t[5]=s=>n.value=Math.min(k.value,n.value+1)),disabled:n.value===k.value,class:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[h(w(ve),{class:"h-5 w-5"})],8,pt)])])])])):g("",!0)]),A.value?(r(),a("div",mt,[e("div",xt,[e("div",gt,[e("div",vt,[t[21]||(t[21]=e("h3",{class:"text-lg font-medium text-gray-900"},"Enrollment Details",-1)),e("button",{onClick:t[6]||(t[6]=s=>A.value=!1),class:"text-gray-400 hover:text-gray-600"},[h(w(xe),{class:"w-6 h-6"})])]),i.value?(r(),a("div",yt,[e("div",null,[t[24]||(t[24]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Student Information",-1)),e("div",ft,[e("p",null,[t[22]||(t[22]=e("strong",null,"Name:",-1)),u(" "+l((d=i.value.student)==null?void 0:d.name),1)]),e("p",null,[t[23]||(t[23]=e("strong",null,"Email:",-1)),u(" "+l((c=i.value.student)==null?void 0:c.email),1)])])]),e("div",null,[t[27]||(t[27]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Course Information",-1)),e("div",ht,[e("p",null,[t[25]||(t[25]=e("strong",null,"Course:",-1)),u(" "+l((p=i.value.course)==null?void 0:p.title),1)]),e("p",null,[t[26]||(t[26]=e("strong",null,"Instructor:",-1)),u(" "+l(($=(j=i.value.course)==null?void 0:j.instructor)==null?void 0:$.name),1)])])]),e("div",null,[t[31]||(t[31]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Enrollment Details",-1)),e("div",wt,[e("p",null,[t[28]||(t[28]=e("strong",null,"Status:",-1)),e("span",{class:N(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ml-2",{"bg-yellow-100 text-yellow-800":i.value.status==="pending","bg-green-100 text-green-800":i.value.status==="approved","bg-blue-100 text-blue-800":i.value.status==="completed","bg-red-100 text-red-800":i.value.status==="rejected"}])},l(i.value.status),3)]),e("p",null,[t[29]||(t[29]=e("strong",null,"Enrollment Date:",-1)),u(" "+l(F(i.value.enrolled_at)),1)]),i.value.completed_at?(r(),a("p",bt,[t[30]||(t[30]=e("strong",null,"Completion Date:",-1)),u(" "+l(F(i.value.completed_at)),1)])):g("",!0)])]),e("div",null,[t[34]||(t[34]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Progress",-1)),e("div",_t,[e("p",null,[t[32]||(t[32]=e("strong",null,"Progress:",-1)),u(" "+l(i.value.progress_percentage||0)+"%",1)]),i.value.grade?(r(),a("p",kt,[t[33]||(t[33]=e("strong",null,"Grade:",-1)),u(" "+l(i.value.grade),1)])):g("",!0)])])])):g("",!0),e("div",Ct,[e("button",{onClick:t[7]||(t[7]=s=>A.value=!1),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400"}," Close ")])])])])):g("",!0),T.value?(r(),a("div",Et,[e("div",jt,[e("div",$t,[t[35]||(t[35]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Confirm Delete",-1)),e("p",Mt,' Are you sure you want to delete enrollment "'+l((z=(M=_.value)==null?void 0:M.student)==null?void 0:z.name)+" - "+l((U=(I=_.value)==null?void 0:I.course)==null?void 0:U.title)+'"? This action cannot be undone. ',1),e("div",Dt,[e("button",{onClick:t[8]||(t[8]=s=>T.value=!1),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400"}," Cancel "),e("button",{onClick:ne,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700"}," Delete ")])])])])):g("",!0)])}}};export{Vt as default};
